<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Überstunden – Lowpoly FPS Horror</title>
  <style>
    :root { --fg:#eaeaf2; --bg:#000; }
    html,body { margin:0; height:100%; background:var(--bg); color:var(--fg); font-family:Inter,system-ui,Segoe UI,Arial,sans-serif; overflow:hidden; }
    #overlay { position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
      background:radial-gradient(1000px 600px at 50% 50%, rgba(0,0,0,.35), rgba(0,0,0,.92)); z-index:5; }
    .panel { max-width:720px; padding:24px; border-radius:14px; background:rgba(15,15,20,.6); border:1px solid rgba(255,255,255,.12); backdrop-filter:blur(6px); }
    .panel h1 { margin:0 0 10px; font-size:26px; }
    .btn { display:inline-block; margin-top:10px; padding:12px 18px; border-radius:10px; background:#0d6efd; color:#fff; border:none; cursor:pointer; font-weight:600; }
    #crosshair { position:fixed; inset:0; pointer-events:none; display:none; }
    #crosshair::after { content:""; position:absolute; top:50%; left:50%; width:12px; height:12px; margin:-6px 0 0 -6px; border-radius:50%; border:2px solid rgba(255,255,255,.5); }
    #hint { position:fixed; bottom:24px; left:50%; transform:translateX(-50%); padding:6px 10px; border-radius:8px; border:1px solid rgba(255,255,255,.12); background:rgba(15,15,20,.6); display:none; }
  </style>
</head>
<body>
  <div id="overlay">
    <div class="panel">
      <h1>Überstunden – Nachtschicht</h1>
      <p>WASD bewegen · Shift rennen · Maus zum Umschauen · Klick sperrt Maus.</p>
      <button id="startBtn" class="btn">Schicht starten</button>
      <div style="opacity:.75; font-size:12px; margin-top:8px;">HTML5/WebGL – läuft direkt über GitHub Pages.</div>
    </div>
  </div>
  <div id="crosshair"></div>
  <div id="hint">Klicke ins Spiel, um die Maus zu sperren</div>

  <!-- Import Map: macht "three" im Browser auflösbar -->
  <script type="importmap">
  {
    "imports": {
      "three": "https://unpkg.com/three@0.150.1/build/three.module.js"
    }
  }
  </script>

  <script type="module">
    import * as THREE from "three";
    import { PointerLockControls } from "https://unpkg.com/three@0.150.1/examples/jsm/controls/PointerLockControls.js";

    // DOM
    const overlay = document.getElementById('overlay');
    const startBtn = document.getElementById('startBtn');
    const crosshair = document.getElementById('crosshair');
    const hint = document.getElementById('hint');

    // Globals
    let scene, camera, renderer, controls;
    const clock = new THREE.Clock();
    const velocity = new THREE.Vector3();
    const direction = new THREE.Vector3();
    const keys = { w:false, a:false, s:false, d:false, shift:false };

    // Input
    addEventListener('keydown', (e)=>{
      if(e.code==='KeyW') keys.w=true;
      if(e.code==='KeyA') keys.a=true;
      if(e.code==='KeyS') keys.s=true;
      if(e.code==='KeyD') keys.d=true;
      if(e.code==='ShiftLeft'||e.code==='ShiftRight') keys.shift=true;
    });
    addEventListener('keyup', (e)=>{
      if(e.code==='KeyW') keys.w=false;
      if(e.code==='KeyA') keys.a=false;
      if(e.code==='KeyS') keys.s=false;
      if(e.code==='KeyD') keys.d=false;
      if(e.code==='ShiftLeft'||e.code==='ShiftRight') keys.shift=false;
    });

    function init(){
      // Scene / Camera / Renderer
      scene = new THREE.Scene();
      scene.background = new THREE.Color(0x000000);

      camera = new THREE.PerspectiveCamera(75, innerWidth/innerHeight, 0.1, 500);
      camera.position.set(0, 1.7, 5);

      renderer = new THREE.WebGLRenderer({ antialias:true });
      renderer.setSize(innerWidth, innerHeight);
      renderer.setPixelRatio(Math.min(devicePixelRatio, 2));
      document.body.appendChild(renderer.domElement);

      // Lights
      scene.add(new THREE.HemisphereLight(0xccccff, 0x080820, 0.6));
      const dir = new THREE.DirectionalLight(0xffffff, 0.6);
      dir.position.set(5,10,7); scene.add(dir);

      // Floor + Wand (damit Bewegung sichtbar ist)
      const floor = new THREE.Mesh(
        new THREE.PlaneGeometry(100,100),
        new THREE.MeshStandardMaterial({ color:0x222222, roughness:1 })
      );
      floor.rotation.x = -Math.PI/2;
      floor.receiveShadow = true;
      scene.add(floor);

      const wallMat = new THREE.MeshStandardMaterial({ color:0x2a2d34, roughness:.9 });
      const wall = new THREE.Mesh(new THREE.BoxGeometry(20,3,0.3), wallMat);
      wall.position.set(0,1.5,-10); scene.add(wall);

      // Pointer Lock
      controls = new PointerLockControls(camera, renderer.domElement);
      scene.add(controls.getObject());
      controls.addEventListener('lock', ()=>{ crosshair.style.display='block'; hint.style.display='none'; });
      controls.addEventListener('unlock', ()=>{ crosshair.style.display='none'; hint.style.display='block'; });
      renderer.domElement.addEventListener('pointerdown', ()=>{ if(!controls.isLocked) controls.lock(); });

      // Resize
      addEventListener('resize', ()=>{
        camera.aspect = innerWidth/innerHeight; camera.updateProjectionMatrix();
        renderer.setSize(innerWidth, innerHeight);
      });
    }

    function animate(){
      requestAnimationFrame(animate);
      const delta = clock.getDelta();

      // Dämpfung
      velocity.x -= velocity.x * 10 * delta;
      velocity.z -= velocity.z * 10 * delta;

      // Richtung
      direction.z = (keys.w?1:0) - (keys.s?1:0);
      direction.x = (keys.d?1:0) - (keys.a?1:0);
      if(direction.lengthSq()>0) direction.normalize();

      // Geschwindigkeit
      const speed = keys.shift ? 8.0 : 4.0;
      velocity.z -= direction.z * speed * 10 * delta;
      velocity.x -= direction.x * speed * 10 * delta;

      if(controls && controls.isLocked){
        controls.moveForward(-velocity.z * delta);
        controls.moveRight(-velocity.x * delta);
      }

      renderer.render(scene, camera);
    }

    // Start
    startBtn.addEventListener('click', ()=>{
      overlay.style.display='none';
      hint.style.display='block';
      init();
      animate();
    });
  </script>
</body>
</html>
